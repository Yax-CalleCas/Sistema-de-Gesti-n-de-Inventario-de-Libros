<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Gestión de Categorías</title>
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<link rel="stylesheet" th:href="@{/Css/AdminCategorias.css}">
</head>
<body>

	<nav class="navbar navbar-custom navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<a class="navbar-brand" href="/admin">Panel de Administración</a>
			</div>
		</div>
	</nav>

	<div class="container" style="margin-top: 80px;">
		<div class="row">
			<div class="col-xs-12">
				<h2 class="pull-left">Gestión de Categorías</h2>
				<div class="pull-right">
					<a th:href="@{/admin}" class="btn btn-info">Volver</a>
				</div>
			</div>
		</div>
		<hr>

		<div class="row">
			<div class="col-md-5">
				<div class="form-panel">
					<h3 th:text="${categoria.id != null} ? 'Editar Categoría' : 'Crear Nueva Categoría'"></h3>
					<hr>

					<form th:action="@{/admin/categorias}" th:object="${categoria}"
						method="post">

						<input type="hidden" th:field="*{id}" />

						<div class="form-group">
							<label for="nombre">Nombre:</label> 
							<input type="text" th:field="*{nombre}" class="form-control"
								placeholder="Nombre de la categoría" required>
						</div>
                        
                        <div class="form-group">
							<label for="urlIcono">URL del Icono:</label> 
							<input type="url" th:field="*{urlIcono}" class="form-control"
								placeholder="URL de la imagen o icono (opcional)">
						</div>
                        
						<div class="form-group">
							<label for="descripcion">Descripción:</label> 
							<textarea th:field="*{descripcion}" class="form-control"
								placeholder="Descripción opcional"></textarea>
						</div>

						<div class="form-group">
							<button type="submit" class="btn btn-success">
                                <span class="glyphicon glyphicon-ok"></span> 
                                Guardar
                            </button>
                            <a th:href="@{/admin/categorias}" class="btn btn-default">
                                <span class="glyphicon glyphicon-remove"></span>
                                Cancelar
                            </a>
						</div>
					</form>
				</div>
			</div>

			<div class="col-md-7">
				<table class="table table-striped table-bordered table-hover">
					<thead>
						<tr>
							<th class="col-md-1">ID</th>
                            <th class="col-md-1">Icono</th>
							<th class="col-md-3">Nombre</th>
							<th class="col-md-4">Descripción</th>
							<th class="col-md-3">Acciones</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="cat : ${categorias}">
							<td th:text="${cat.id}"></td>
                            
                            <td class="text-center">
					            <img th:if="${cat.urlIcono != null and cat.urlIcono != ''}"
					                 th:src="${cat.urlIcono}"
					                 alt="Icono"
					                 class="categoria-icon">
					            <span th:unless="${cat.urlIcono != null and cat.urlIcono != ''}" class="text-muted">
					                <span class="glyphicon glyphicon-tag"></span>
					            </span>
					        </td>

							<td th:text="${cat.nombre}"></td>
							<td>
                                <span th:text="${#strings.substring(#strings.defaultString(cat.descripcion, 'Sin descripción'), 0, #strings.length(cat.descripcion) > 50 ? 50 : #strings.length(cat.descripcion)) + (#strings.length(cat.descripcion) > 50 ? '...' : '')}"></span>
                            </td>
							
							<td class="action-buttons">
								<a th:href="@{'/admin/categorias/editar/' + ${cat.id}}"
									class="btn btn-info btn-sm" title="Editar">
									<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
								</a> 
								<a th:href="@{'/admin/categorias/eliminar/' + ${cat.id}}"
									class="btn btn-danger btn-sm"
									onclick="return confirm('¿Seguro que deseas eliminar esta categoría?')"
									title="Eliminar"> 
                                    <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
								</a>
							</td>
						</tr>
						<tr th:if="${#lists.isEmpty(categorias)}">
							<td colspan="5" class="text-center text-muted">No hay
								categorías registradas.</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
    

	</div>
<div th:replace="fragments/footer :: siteFooter"></div>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
	<script
		src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</body>
</html>