<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <title>Gestión de Libros | BookFlow</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">

 <link rel="stylesheet" th:href="@{/css/adminLibros.css}">
 <style>
     /* Estilo para asegurar que las columnas de portada y acciones no se expandan */
     .col-portada { width: 70px; }
     .col-acciones { width: 100px; }
     .col-stock { width: 90px; }
 </style>
</head>

<body class="container-fluid py-4">
    
    <div class="text-center mb-5">
        <h2>
            <i class="fa-solid fa-book-open me-2"></i> Inventario de Libros
        </h2>
        <p class="text-muted">Administra fácilmente tu colección y mantén tu inventario actualizado</p>
    </div>

    <div class="d-flex justify-content-between mb-4 flex-wrap gap-2">
        <a th:href="@{/admin/libros/nuevo}" class="btn btn-success btn-lg shadow-sm">
            <i class="fa-solid fa-circle-plus me-1"></i> Nuevo Libro
        </a>
        <a th:href="@{/admin}" class="btn btn-outline-secondary btn-lg shadow-sm">
            <i class="fa-solid fa-arrow-left me-1"></i> Volver al Panel
        </a>
    </div>

    <div class="table-responsive shadow-sm">
        <table class="table table-hover align-middle text-center">
            <thead>
                <tr>
                    <th class="col-portada"></th> 
                    <th>Título</th>
                    <th>Precio</th>
                    <th class="col-stock">Stock</th>
                    <th class="d-none d-sm-table-cell">Autor</th>
                    <th class="d-none d-md-table-cell">Categoría</th>
                    <th class="d-none d-lg-table-cell">ISBN</th>
                    <th class="col-acciones">Acciones</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="libro : ${libros}">
                    <td class="col-portada">
                        <img th:if="${libro.imagenUrl}" th:src="${libro.imagenUrl}" 
                             alt="Portada" style="width: 55px; height: 75px; object-fit: cover; border-radius: 5px;">
                        <i th:unless="${libro.imagenUrl}" class="fa-solid fa-book-bookmark text-secondary fa-2x"></i>
                    </td>

                    <td class="fw-semibold text-primary text-start" th:text="${libro.titulo}"></td>
                    
                    <td class="fw-bold text-success" th:text="${#numbers.formatCurrency(libro.precioFinal)}"></td>
                    
                    <td class="col-stock">
                        <span th:text="${libro.stock}"
                              th:classappend="${libro.stock le 10 ? 'badge bg-danger' : 'badge bg-success'}"></span>
                    </td>
                    
                    <td th:text="${libro.autor.nombre}" class="d-none d-sm-table-cell"></td>
                    
                    <td th:text="${libro.categoria.nombre}" class="d-none d-md-table-cell"></td>
                    
                    <td th:text="${libro.isbn}" class="small text-muted d-none d-lg-table-cell"></td>

                    <td class="col-acciones">
                        <div class="d-flex justify-content-center gap-2">
                            <a th:href="@{/admin/libros/editar/{id}(id=${libro.id})}" class="btn btn-sm btn-info" title="Editar">
                                <i class="fa-solid fa-pen-to-square"></i>
                            </a>
                            <a th:href="@{/admin/libros/eliminar/{id}(id=${libro.id})}" class="btn btn-sm btn-danger" title="Eliminar"
                               onclick="return confirm('¿Seguro que deseas eliminar este libro?')">
                                <i class="fa-solid fa-trash-can"></i>
                            </a>
                        </div>
                    </td>
                </tr>

                <tr th:if="${#lists.isEmpty(libros)}">
                    <td colspan="8" class="text-center py-4 text-muted">
                        <i class="fa-solid fa-circle-info me-2"></i>No hay libros registrados actualmente.
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <footer>
        <p><i class="fa-regular fa-copyright"></i> Sistema BookFlow © 2025 — Desarrollado por Yaxon Calle</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>